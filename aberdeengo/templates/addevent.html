{% extends "layout.html" %}
{% block content %}

        <h2>Event Information</h2>
        <form id="formA" action="{% url 'addevent'%}" method="post">
            {% csrf_token %}
            <label for="title">Event Name</label>
				<input type="text" id="title" name="title" placeholder="Your Event">
				<br>
				<label for="title">Event Location - <i>Click where your event will be held</i></label>
				<input type="hidden" id="location" name="location" placeholder="Your Location">
				<div id="map" style="width:100%;height:500px;"></div>

        <script>
        
        var markersArray = []; // A 1D Array for holding one marker.
        
        function initMap() {
          var map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: -34.397, lng: 150.644},
            zoom: 13
          });
          
          google.maps.event.addListener(map, 'click', function(event) {
            placeMarker(map, event.latLng);
            document.forms['formA'].elements['location'].value = event.latLng;
          });
          
          var infoWindow = new google.maps.InfoWindow({map: map});
  
          // Try HTML5 geolocation.
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
              var pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
              };
  
              infoWindow.setPosition(pos);
              infoWindow.setContent('You are here.');
              map.setCenter(pos);
            }, function() {
              handleLocationError(true, infoWindow, map.getCenter());
            });
          } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
          }
        }
  
        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
          infoWindow.setPosition(pos);
          infoWindow.setContent(browserHasGeolocation ?
                                'Error: The Geolocation service failed.' :
                                'Error: Your browser doesn\'t support geolocation.');
        }
        
        function placeMarker(map, location) {
            var marker = new google.maps.Marker({
              position: location,
              map: map
            });
           
            clearOverlays();
            markersArray.push(marker);
            
            var infowindow = new google.maps.InfoWindow({
              content: 'Latitude: ' + location.lat() + '<br>Longitude: ' + location.lng()
            });
            infowindow.open(map,marker);
          }
          
        function clearOverlays() {
          for (var i = 0; i < markersArray.length; i++ ) {
            markersArray[i].setMap(null);
          }
          markersArray.length = 0;
          markersArray = [];
        }
        </script>
		<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyClKcWsgdYmlnLItSUiD5YaJgbrD9ahed4&callback=initMap">
    </script>
    
				<br>
				<label for="title">Event Description</label>
				<input type="text" id="description" name="description" placeholder="What your event is about">
				<br>
				<label for="title">Event Start Date</label>
				<input type="text" id="startdate" name="startdate" placeholder="2016-11-25T12:00:00">
				<br>
				<label for="title">Event End Date</label>
				<input type="text" id="enddate" name="enddate" placeholder="2016-11-25T12:01:00">
				<br>
				<!--{% for tag in tags %}-->
				<!--<label>-->
				<!--  <input type="checkbox" name="tags">{{tag.name}}-->
				<!--</label>-->
				<!--{% endfor %}-->
				<!--<br>-->
				<br>
          
    
    
        <script>
        function selectTag(select)
        {
          var option = select.options[select.selectedIndex];
          var ul = select.parentNode.getElementsByTagName('ul')[0];
     
          var choices = ul.getElementsByTagName('input');
          for (var i = 0; i < choices.length; i++)
          if (choices[i].value == option.value)
            return;
     
          var li = document.createElement('li');
          var input = document.createElement('input');
          var text = document.createTextNode(option.firstChild.data);
     
          input.type = 'hidden';
          input.name = 'tags[]';
          input.value = option.value;

          li.appendChild(input);
          li.appendChild(text);
          li.setAttribute('onclick', 'this.parentNode.removeChild(this);');     
    
          ul.appendChild(li);
          }
        </script>
    
        <ul>
        </ul>
        <select onchange="selectTag(this);">
        {% for tag in tags%}
          <option value="{{tag.id}}">{{tag.name}}</option>
        {% endfor %}
        </select>

          <br>
          <br>
          <br>
          <br>
				<input type="submit" value="submit">
    </div>

  {% endblock %}
